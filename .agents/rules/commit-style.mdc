---
description: Commit message format and conventions
alwaysApply: false
globs: ["**/.claude/commands/**", "**/lefthook.yml"]
---

# Commit Style

Use this format when committing changes (e.g. via `agent-commit-push`, `worktree-pr`, or manual commits).

## Message Format

```
${emoji} ${type}(${scope}): ${summary}

- ${change_detail_1}
- ${change_detail_2}
```

## Type â†’ Emoji Mapping

| type     | emoji | usage                       |
| -------- | ----- | --------------------------- |
| chore    | ğŸ±    | config, dependencies, build |
| docs     | ğŸ“    | documentation               |
| style    | ğŸ’„    | formatting, UI              |
| refactor | â™»ï¸    | refactoring                 |
| perf     | ğŸš€    | performance improvement     |
| feat     | âœ¨    | new feature                 |
| fix      | ğŸ›    | bug fix                     |
| test     | ğŸ’š    | tests                       |

## Commit Order

`chore â†’ docs â†’ style â†’ refactor â†’ perf â†’ feat â†’ fix â†’ test`

## Scope Guidelines

- `db` â€” schema, migrations, D1/Drizzle
- `api` or `server` â€” API routes, server logic
- `web` or `app` â€” pages, components, client UI
- `infra` â€” docker, .github/, wrangler, deployment
- `deps` â€” package.json, lockfiles
- `openclaw` â€” OpenClaw/Moltworker agent prompts and config
- When changes span multiple scopes: pick the most impactful scope, or use `core`

## Commands (agent commits only)

Set `GIT_AUTHOR_*` / `GIT_COMMITTER_*` to your agent identity before commit:

```bash
git add -A -- ${file1} ${file2} ${fileN}
GIT_AUTHOR_NAME="..." GIT_AUTHOR_EMAIL="..." GIT_COMMITTER_NAME="..." GIT_COMMITTER_EMAIL="..." git commit -m "${emoji} ${type}(${scope}): ${summary}" -m "- ${detail1}\n- ${detail2}"
```

## Staging Rules

- Follow `.gitignore` strictly. Never stage `.env`, `.cursor/**` (except commands), credentials
- Group by intent/responsibility, not only by folder
