# Modular Zsh Configuration

この設定は機能別に**合理的に**分割され、環境変数は`.zshenv`に集約されたモジュラー構成になっています。

## 📁 ファイル構成

```
~/.zshenv                  # 環境変数・PATH設定（統合）
~/.zshrc                   # メイン設定ファイル（他ファイルを読み込み）
~/.config/zsh/             # モジュール化された設定ファイル群
├── zsh-config.zsh         # zsh基本設定（履歴・オプション・補完）
├── ui.zsh                 # UI・プラグイン・プロンプト
├── aliases.zsh            # コマンドエイリアス・ショートカット
├── functions.zsh          # カスタムシェル関数
└── tools.zsh              # 開発ツール読み込み
```

## 🔧 各ファイルの役割

### `.zshenv`
- **全ての環境変数とPATH設定を統合**
- PATH重複防止ヘルパー関数
- XDG Base Directory準拠
- 開発ツール別に整理された環境変数
- シェル起動時に最初に読み込まれる

### `.zshrc`
- メインの設定ファイル
- `~/.config/zsh/`ディレクトリ内の全ファイルを自動読み込み
- Amazon Q の前後処理を含む

### `~/.config/zsh/` ディレクトリ内のファイル

| ファイル | 内容 | 統合された旧ファイル |
|---------|------|---------------------|
| `zsh-config.zsh` | **zsh本体の基本設定**<br>• 履歴設定<br>• 基本オプション<br>• 補完設定 | history.zsh, options.zsh, completion.zsh |
| `ui.zsh` | **UI・見た目関連**<br>• プラグイン（autosuggestions, syntax-highlighting）<br>• プロンプト設定（Starship） | plugins.zsh, prompt.zsh |
| `aliases.zsh` | **コマンドエイリアス**<br>• ファイル操作ショートカット<br>• 開発ツールエイリアス<br>• エディタ・ユーティリティコマンド | aliases.zsh |
| `functions.zsh` | **カスタム関数**<br>• ディレクトリ作成・ナビゲーションヘルパー<br>• ファイル検索・操作ユーティリティ<br>• アーカイブ展開関数 | functions.zsh |
| `tools.zsh` | **開発ツール読み込み**<br>• ライブラリ初期化のみ<br>• 環境変数は.zshenvに移動済み | 環境変数部分を除いた既存ファイル |

## ✨ 改善点・メリット

### 🎯 合理的な分割
1. **論理的なグループ化**: 関連性の高い機能を適切にまとめ
2. **zsh本体設定の統合**: 細分化していた基本設定を一つに集約
3. **UI関連の統合**: プラグインとプロンプトを見た目系として統合
4. **エイリアス・関数の分離**: 単純なコマンド置換と複雑な関数を分離
5. **環境変数の完全分離**: 全て`.zshenv`に集約で管理簡易化

### �� 実用性の向上
6. **保守性**: 機能別に分離されているため修正が簡単
7. **可読性**: 各ファイルが明確な責務を持つ
8. **拡張性**: 新しい機能は適切なファイルに追加可能
9. **デバッグ**: 問題の原因となるファイルを特定しやすい
10. **パフォーマンス**: 起動時の最適化設定を含む

## 🚀 使用方法

1. ターミナルを再起動するか `source ~/.zshrc` を実行
2. **環境変数変更**: `.zshenv` を編集
3. **zsh基本設定変更**: `zsh-config.zsh` を編集
4. **見た目・プラグイン変更**: `ui.zsh` を編集
5. **エイリアス変更**: `aliases.zsh` を編集
6. **カスタム関数変更**: `functions.zsh` を編集
7. **開発ツール変更**: `tools.zsh` を編集
8. 変更後は `reload` エイリアスまたは `source ~/.zshrc` で反映

## 📝 カスタマイズガイド

### 新しい環境変数を追加
`.zshenv` に追記（PATH設定はヘルパー関数を使用）

### 新しいzsh設定を追加
`zsh-config.zsh` に追記

### 新しいプラグインを追加
`ui.zsh` に追記

### 新しいエイリアスを追加
`aliases.zsh` に追記

### 新しいカスタム関数を追加
`functions.zsh` に追記

### 新しい開発ツールを追加
`tools.zsh` に追記

## 🔧 PATH管理

`.zshenv`では以下のヘルパー関数を使用：

```bash
path_prepend "/path/to/dir"  # PATHの先頭に追加（重複チェック付き）
path_append "/path/to/dir"   # PATHの末尾に追加（重複チェック付き）
```

これにより、PATH変数の重複や肥大化を防げます。

## 📊 構成の比較

| 項目 | 旧構成（細分化） | 新構成（合理化） |
|------|------------------|------------------|
| ファイル数 | 8〜9個 | **5個** |
| zsh基本設定 | 3ファイルに分散 | **1ファイルに統合** |
| エイリアス・関数 | 1ファイルに混在 | **機能別に分離** |
| 管理の複雑さ | 高い | **適度** |
| 機能の関連性 | バラバラ | **論理的** |
| 初心者にとっての理解しやすさ | 低い | **高い** | 